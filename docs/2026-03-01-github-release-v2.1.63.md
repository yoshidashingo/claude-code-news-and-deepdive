---
title: "Claude Code v2.1.63 リリース — HTTP フック、新スラッシュコマンド、大規模メモリリーク修正"
date: 2026-03-01
source: github-release
source_url: "https://github.com/anthropics/claude-code/releases/tag/v2.1.63"
identifier: "v2.1.63"
---

# Claude Code v2.1.63 リリース — HTTP フック、新スラッシュコマンド、大規模メモリリーク修正

## 概要

Claude Code v2.1.63 は、HTTP フックの追加や新しいバンドルスラッシュコマンドの導入など、複数の新機能を搭載したリリースです。また、長時間セッションで問題となっていたメモリリークを中心に 10 件以上のバグ修正が行われており、安定性・パフォーマンスが大幅に向上しています。MCP（Model Context Protocol）周辺の改善も引き続き積極的に行われています。

## 新機能

### `/simplify` と `/batch` バンドルスラッシュコマンドの追加

新たに 2 つのスラッシュコマンドが標準バンドルとして追加されました。

- **`/simplify`** — 変更されたコードを対象に、再利用性・品質・効率の観点でレビューし、問題を修正するスキルです。
- **`/batch`** — バッチ処理を実行するためのスラッシュコマンドです。

これらはユーザーが呼び出せる組み込みスキルとして提供されており、プロジェクトへの追加設定なしで利用できます。

### HTTP フックのサポート

これまでのフック機能はシェルコマンドを実行する形式でしたが、v2.1.63 では **HTTP フック**が追加されました。指定した URL に JSON を POST し、JSON レスポンスを受け取る形でフックを実装できます。

```json
{
  "hooks": {
    "PreToolUse": [
      {
        "type": "http",
        "url": "https://example.com/hook",
        "method": "POST"
      }
    ]
  }
}
```

外部サービスや社内システムとのインテグレーションを、シェルスクリプトを介さずに直接 HTTP で行えるようになりました。CI/CD パイプラインや Webhook との連携がより柔軟になります。

### `/copy` コマンドに「Always copy full response」オプションを追加

`/copy` コマンドのピッカーに **「Always copy full response」** オプションが追加されました。このオプションを選択すると、以降の `/copy` コマンドはコードブロックの選択ダイアログをスキップし、レスポンス全体を直接クリップボードにコピーします。毎回の操作を短縮したいユーザーにとって便利な設定です。

### `/model` コマンドの改善

`/model` コマンドのスラッシュコマンドメニューに、**現在アクティブなモデルが表示**されるようになりました。どのモデルが使用中かを確認するために別途コマンドを実行する必要がなくなります。

### MCP OAuth 認証の手動 URL ペーストフォールバック

MCP の OAuth 認証フローで、自動的な localhost リダイレクトが機能しない場合に、**コールバック URL を手動でペースト**してブラウザ認証を完了できるフォールバック機能が追加されました。リモート環境やプロキシ環境でのセットアップ時に役立ちます。

### VSCode 拡張機能の強化

- **セッションのリネームと削除** — セッション一覧からセッションを直接リネーム・削除できるアクションが追加されました。
- **リモートセッションの会話履歴表示** — リモートセッションが会話履歴に正しく表示されない問題が修正されました。

## 改善点

### プロジェクト設定・オートメモリの git worktree 間共有

プロジェクト設定（Project configs）とオートメモリが、**同じリポジトリの git worktree 全体で共有**されるようになりました。複数の worktree を使って並行開発を行う場合でも、設定やメモリの状態が一貫して利用できます。

### `ENABLE_CLAUDEAI_MCP_SERVERS` 環境変数

```bash
ENABLE_CLAUDEAI_MCP_SERVERS=false
```

この環境変数を設定することで、claude.ai の MCP サーバーを利用可能にする機能をオプトアウトできます。セキュリティポリシーや企業環境での制御に活用できます。

## バグ修正

### UI の表示修正

ローカルスラッシュコマンド（`/cost` など）の出力が、システムメッセージではなくユーザー送信メッセージとして UI に表示されていた問題が修正されました。

### `/clear` コマンドのスキルキャッシュリセット修正

`/clear` コマンドを実行してもキャッシュされたスキルがリセットされず、古いスキルの内容が新しい会話に持ち越されてしまう問題が修正されました。

### 大規模なメモリリーク修正

本リリースでは、長時間セッションの安定性を脅かしていた多数のメモリリークが修正されています。

| 修正箇所 | 内容 |
|---|---|
| ブリッジポーリングループ | リスナーリークを修正 |
| MCP OAuth フロークリーンアップ | リスナーリークを修正 |
| フック設定メニュー | ナビゲーション時のメモリリークを修正 |
| インタラクティブパーミッションハンドラー | 自動承認時のリスナーリークを修正 |
| WebSocket トランスポート再接続 | リスナーリークを修正 |
| git root 検出キャッシュ | 長時間セッションでの無制限な増加を修正 |
| JSON パースキャッシュ | 長時間セッションでの無制限な増加を修正 |
| MCP サーバーフェッチキャッシュ | 切断時に未クリアだった問題を修正 |
| MCP ツール/リソースキャッシュ | サーバー再接続時のリークを修正 |
| IDE ホスト IP 検出キャッシュ | ポートをまたいだ結果の誤共有を修正 |
| Bash コマンドプレフィックスキャッシュ | メモリリークを修正 |
| ファイルカウントキャッシュ | glob の ignore パターンを無視していた問題を修正 |
| サブエージェントの進捗メッセージ | コンテキスト圧縮時に重いペイロードを削除してメモリ効率を改善 |
| 長時間実行チームメイト | 会話圧縮後も AppState にすべてのメッセージを保持していた問題を修正 |

### REPL ブリッジのレース条件修正

初期接続フラッシュ中に、履歴メッセージと新着メッセージがインターリーブされることでメッセージの順序が乱れるレース条件が修正されました。

## 技術的なポイント

- **HTTP フックの導入**により、外部システムとの統合がシェルスクリプト不要で実現できます。JSON ベースのインターフェースで型安全な連携が可能です。
- **メモリリーク修正が 10 件以上**集中して行われており、長時間セッションや MCP サーバーを多用する環境での安定性が大きく改善されます。特にサブエージェントを活用する複雑なタスクでの効果が期待されます。
- **git worktree 対応**が強化され、`git worktree` を使った並行作業フローが公式にサポートされた形になりました。モノレポや大規模なフィーチャー開発への対応が進んでいます。
- **MCP 周辺の改善**が継続しており、OAuth 認証のフォールバック、キャッシュリーク修正、フェッチキャッシュのライフサイクル管理など、プロダクション利用に向けた成熟が見られます。
- `/simplify` と `/batch` はバンドル済みスラッシュコマンドとして提供されるため、ユーザーはプロジェクト設定を変更せずにすぐ利用できます。

## まとめ

v2.1.63 は新機能と安定性改善を両立したリリースです。HTTP フックの追加はフック機能の拡張性を大きく高め、外部サービスとの連携を容易にします。また、今回集中的に行われたメモリリーク修正は、長時間にわたる複雑なエージェントタスクを実行するユーザーにとって特に重要な改善です。MCP エコシステムの成熟も着実に進んでおり、今後さらに実用的な活用シーンが広がることが期待されます。
