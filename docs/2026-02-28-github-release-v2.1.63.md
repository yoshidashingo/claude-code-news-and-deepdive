---
title: "Claude Code v2.1.63 リリース — HTTP Hooks、/simplify・/batch コマンド追加と大規模なメモリリーク修正"
date: 2026-02-28
source: github-release
source_url: "https://github.com/anthropics/claude-code/releases/tag/v2.1.63"
identifier: "v2.1.63"
---

# Claude Code v2.1.63 リリース — HTTP Hooks、/simplify・/batch コマンド追加と大規模なメモリリーク修正

## 概要

Claude Code v2.1.63 が 2026年2月28日にリリースされました。このリリースでは、新しいバンドル済みスラッシュコマンド `/simplify` と `/batch` の追加、シェルコマンドの代替となる HTTP Hooks 機能の導入など、実用的な新機能が加わっています。また、長期稼働セッションに影響していた複数のメモリリークが集中的に修正されており、安定性と信頼性の大幅な向上が図られています。

## 新機能

### `/simplify` および `/batch` スラッシュコマンドの追加

2つの新しいバンドル済みスラッシュコマンドが追加されました。

- **`/simplify`**: コードのリファクタリングや簡略化を支援するコマンドです。変更したコードの再利用性・品質・効率性を見直し、問題があれば修正します。
- **`/batch`**: 複数のタスクをまとめて処理するためのコマンドです。繰り返し作業の自動化に活用できます。

### HTTP Hooks の導入

従来のシェルコマンドを実行する Hooks に加えて、**HTTP Hooks** が新たにサポートされました。HTTP Hooks を使うと、特定のイベント発生時に指定した URL へ JSON データを POST し、レスポンスとして JSON を受け取ることができます。

```json
{
  "hooks": {
    "PreToolUse": [
      {
        "matcher": "Bash",
        "hooks": [
          {
            "type": "http",
            "url": "https://example.com/hook",
            "timeout": 10
          }
        ]
      }
    ]
  }
}
```

これにより、外部サービスや社内ツールとの連携がシェルスクリプトを介さずに直接行えるようになります。CI/CD パイプラインや監査ログシステムとの統合に特に有用です。

### `/model` コマンドの改善

`/model` コマンドのスラッシュコマンドメニューで、**現在アクティブなモデルが表示される**ようになりました。どのモデルで作業しているかを即座に確認できるため、モデルを切り替えながら作業する際の混乱を防ぎます。

### `/copy` コマンドに「常に全レスポンスをコピー」オプションを追加

`/copy` コマンドのピッカーに **「Always copy full response（常に全レスポンスをコピー）」** オプションが追加されました。このオプションを選択すると、以降の `/copy` コマンド実行時にコードブロック選択画面をスキップして、レスポンス全体を直接クリップボードにコピーします。長い出力をまとめてコピーしたい場合の操作効率が向上します。

### VSCode: セッションの名前変更・削除アクションの追加

VSCode 拡張機能のセッションリストに、**セッションの名前変更と削除のアクション**が追加されました。複数のセッションを管理しながら作業する場合に、各セッションを識別・整理しやすくなります。

### MCP OAuth 認証の手動 URL ペースト対応

MCP (Model Context Protocol) サーバーの OAuth 認証フローにおいて、自動的な localhost リダイレクトが機能しない環境向けに、**コールバック URL を手動でペーストする**フォールバック手段が追加されました。ネットワーク環境の制約によって OAuth フローが完了できなかったケースでの代替手段として活用できます。

### `ENABLE_CLAUDEAI_MCP_SERVERS=false` 環境変数の追加

claude.ai の MCP サーバーを利用可能にする機能をオプトアウトするための環境変数 **`ENABLE_CLAUDEAI_MCP_SERVERS=false`** が追加されました。セキュリティポリシーやネットワーク制約により claude.ai MCP サーバーへの接続を無効化したい場合に使用します。

```bash
export ENABLE_CLAUDEAI_MCP_SERVERS=false
```

## 改善点

### Git Worktree 間でのプロジェクト設定・自動メモリの共有

同一リポジトリの複数の git worktree 間で、**プロジェクト設定と自動メモリが共有される**ようになりました。これまでは worktree ごとに独立した設定が持たれていましたが、メインリポジトリの設定を worktree でも参照できるようになり、複数ブランチを並行して開発するワークフローでの一貫性が向上します。

## バグ修正

### スラッシュコマンド出力の表示修正

`/cost` などのローカルスラッシュコマンドの出力が、ユーザーが送信したメッセージとして UI に表示されてしまう問題が修正されました。これらの出力は正しくシステムメッセージとして表示されるようになります。

### `/clear` コマンドのキャッシュリセット修正

`/clear` コマンド実行後もキャッシュされたスキルがリセットされず、新しい会話に古いスキルの内容が持ち越されてしまう問題が修正されました。

### VSCode リモートセッションの会話履歴修正

VSCode のリモートセッションが会話履歴に表示されない問題が修正されました。

### REPL ブリッジの競合状態修正

初期接続時のメッセージフラッシュ中に新しいメッセージが到着した場合、メッセージの順序が乱れる可能性があった競合状態が修正されました。

### メモリリークの集中修正

今回のリリースでは、長期稼働セッションやサブエージェントを多用する環境で発生していた多数のメモリリークが修正されています：

- **ブリッジポーリングループ**のリスナーリーク修正
- **MCP OAuth フロークリーンアップ**のリスナーリーク修正
- **インタラクティブ権限ハンドラー**（自動承認時）のリスナーリーク修正
- **Git ルート検出キャッシュ**のメモリリーク修正（長期セッションで無制限に増大する問題）
- **JSON 解析キャッシュ**のメモリリーク修正（長期セッションで無制限に増大する問題）
- **Bash コマンドプレフィックスキャッシュ**のメモリリーク修正
- **MCP ツール・リソースキャッシュ**のサーバー再接続時リーク修正
- **MCP サーバーフェッチキャッシュ**の切断時未クリア問題修正（頻繁に再接続するサーバーで増大）
- **長期稼働のチームメイト**がコンテキスト圧縮後もすべてのメッセージを AppState に保持し続ける問題を修正
- **IDE ホスト IP 検出キャッシュ**がポートをまたいで誤共有される問題を修正
- **WebSocket トランスポート再接続**時のリスナーリーク修正
- **Hooks 設定メニュー**のメモリリーク修正

また、コンテキスト圧縮時にサブエージェントの重い進捗メッセージペイロードを除去することで、長期セッションでのメモリ使用効率が改善されました。

## 技術的なポイント

- **HTTP Hooks** は従来のシェルコマンド型 Hooks の代替として使用でき、外部 API との統合をより安全・シンプルに実装できます
- `ENABLE_CLAUDEAI_MCP_SERVERS=false` は、閉じたネットワーク環境や厳格なセキュリティポリシーを持つ企業環境での Claude Code 利用をサポートします
- 今回の多数のメモリリーク修正は、特に **MCP サーバーを複数利用する環境**や**長時間稼働のセッション**でのリソース消費改善に直結します
- git worktree でのプロジェクト設定共有により、**feature branch 並行開発**ワークフローでの設定管理が一元化されます
- `/simplify` コマンドの追加は、コードレビューや品質改善の作業フローをよりインタラクティブに行えるようにします

## まとめ

v2.1.63 は、新機能と安定性改善の両面でバランスの取れたリリースです。HTTP Hooks の導入により、外部サービスとの統合がより柔軟になりました。また、今回最も注目すべき点は、長期稼働セッションに影響していたメモリリークの集中修正です。MCP サーバーを多用する環境や、Claude Code を継続的に起動し続けて作業するユーザーにとって、実感できるレベルでの安定性向上が期待されます。`/simplify` や `/batch` といった新しいスラッシュコマンドも、日常的な開発作業での活用が見込まれます。
