---
title: "Claude Code v2.1.59 リリース: 自動メモリ保存と /copy コマンドの追加"
date: 2026-03-01
source: github-release
source_url: "https://github.com/anthropics/claude-code/releases/tag/v2.1.59"
identifier: "v2.1.59"
---

# Claude Code v2.1.59 リリース: 自動メモリ保存と /copy コマンドの追加

## 概要

Claude Code v2.1.59 では、Claude が有用なコンテキストを自動的にメモリへ保存する **auto-memory** 機能と、コードブロックを選択的にコピーできる **`/copy` コマンド**が新たに追加されました。また、複合 Bash コマンドの "always allow" プレフィックス推定の精度向上やマルチエージェントセッションのメモリ使用量改善など、複数の品質改善も含まれています。

## 新機能

### Auto-Memory: コンテキストの自動保存

Claude が会話の中で有用だと判断したコンテキストを、自動的に auto-memory ディレクトリへ保存するようになりました。これにより、セッションをまたいでプロジェクト固有の情報（コーディング規約、よく使うコマンド、プロジェクト構成など）を Claude が記憶し、次回以降の会話で活用できます。

保存されたメモリの確認・編集・削除は `/memory` コマンドで管理できます。

```
/memory
```

auto-memory の保存先は `~/.claude/projects/<project-path>/memory/` 以下のディレクトリとなります。不要なメモリが蓄積した場合は `/memory` から削除することで、Claude の動作を意図通りに制御できます。

### `/copy` コマンド: コードブロックの選択的コピー

コードブロックを含むレスポンスに対して `/copy` コマンドを実行すると、インタラクティブなピッカーが表示されます。

```
/copy
```

ピッカーでは以下の選択肢が表示されます:

- **個別のコードブロックを選択**: レスポンス内に複数のコードブロックがある場合、特定のブロックだけをクリップボードにコピーできます
- **レスポンス全体をコピー**: レスポンス全文をそのままコピーします

複数のコードスニペットが含まれる長い回答から必要な部分だけを取り出す際に、スクロールして手動で選択する手間が省けます。

## 改善点

### 複合 Bash コマンドのプレフィックス推定改善

"always allow" 機能（特定のコマンドを常に許可する設定）において、`&&` で連結された複合コマンドに対するプレフィックス推定ロジックが改善されました。

**改善前**: `cd /tmp && git fetch && git push` のような複合コマンド全体を1つのエントリとして扱っていたため、意図しないコマンドまで許可されるリスクがありました。

**改善後**: 複合コマンドをサブコマンド単位に分解し、それぞれに対してスマートなプレフィックスを算出します。これにより、`git fetch` と `git push` をそれぞれ個別のルールとして "always allow" に登録できるようになり、より精緻な権限管理が可能になりました。

### ショートタスクリストの並び順改善

`TodoWrite` などで生成される短いタスクリストの表示順序が改善されました。タスクの優先度や依存関係に基づいたより自然な並び順になります。

### マルチエージェントセッションのメモリ使用量最適化

複数のサブエージェントを並列実行するマルチエージェントセッションにおいて、完了したサブエージェントのタスク状態を適切に解放するようになりました。長時間・多数のサブエージェントを扱うセッションでのメモリ消費が抑制され、安定性が向上します。

## バグ修正

### MCP OAuth トークン更新の競合状態を修正

複数の Claude Code インスタンスを同時に起動している環境で、MCP (Model Context Protocol) の OAuth トークンリフレッシュ時に競合状態（race condition）が発生する問題が修正されました。これにより、複数インスタンスで MCP ツールを並行利用する際の認証エラーや予期しない動作が解消されます。

### 作業ディレクトリ削除時のエラーメッセージ改善

シェルコマンド実行中に作業ディレクトリが削除された場合、以前は不明瞭なエラーが表示されていましたが、状況を明確に示すエラーメッセージが表示されるようになりました。問題の原因特定が容易になります。

## 技術的なポイント

- **Auto-Memory の活用**: プロジェクト固有の情報（使用ライブラリのバージョン、ディレクトリ構造、コーディング規約など）が自動的に記憶されることで、毎回同じ前提を説明する手間が減ります。`/memory` コマンドで定期的に内容を確認し、古くなった情報は削除することを推奨します
- **`/copy` の使いどころ**: コードレビューや複数ファイルへの適用作業で、特定のコードブロックだけを素早く抜き出すのに便利です。特に長い説明を含む回答から特定のスニペットだけを取り出す際に効果的です
- **"always allow" の精度向上**: `&&` や `;` で繋いだ複合コマンドを多用する開発者にとって、より細かい粒度での権限管理が可能になり、セキュリティと利便性のバランスが改善されます
- **マルチエージェントの安定性**: 大規模なタスクを複数サブエージェントで分担する際のリソース管理が改善されており、長時間の並列処理がより安定して動作するようになります
- **MCP 複数インスタンス運用**: チーム開発環境など複数の Claude Code インスタンスが稼働する場面での MCP 統合が信頼性向上します

## まとめ

v2.1.59 は、開発者の日常的なワークフローを改善する実用的なアップデートです。Auto-Memory により Claude がプロジェクトのコンテキストを継続的に学習・活用できるようになり、長期的な開発支援の質が向上することが期待されます。また `/copy` コマンドはシンプルながら日常的な操作の効率を高める機能です。マルチエージェントセッションのメモリ最適化や MCP の競合状態修正は、より高度な Claude Code 活用を行っているユーザーにとって特に重要な安定性改善となります。
