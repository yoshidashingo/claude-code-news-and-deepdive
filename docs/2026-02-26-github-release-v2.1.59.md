---
title: "Claude Code v2.1.59 リリース — 自動メモリ保存・/copy コマンド追加・マルチエージェント改善"
date: 2026-02-26
source: github-release
source_url: "https://github.com/anthropics/claude-code/releases/tag/v2.1.59"
identifier: "v2.1.59"
---

# Claude Code v2.1.59 リリース — 自動メモリ保存・/copy コマンド追加・マルチエージェント改善

## 概要

Claude Code v2.1.59 では、コンテキストを自動的にメモリへ保存する **auto-memory 機能**の追加、コードブロックを選択してコピーできる **`/copy` コマンド**の新設、そしてマルチエージェントセッションにおけるメモリ効率の向上など、開発ワークフローを大きく改善する変更が含まれています。また、MCP の OAuth トークン更新における競合状態の修正や、シェルコマンドのエラー表示改善といったバグ修正も行われています。

## 新機能

### auto-memory — 有用なコンテキストの自動保存

Claude が会話の中で有用と判断したコンテキスト（プロジェクトの構造、よく使うコマンド、ユーザーの好みなど）を自動的にメモリへ保存するようになりました。保存されたメモリは `/memory` コマンドで確認・管理できます。

```
/memory
```

これにより、セッションをまたいで同じ情報を何度も伝える必要がなくなり、長期的な作業の継続性が向上します。メモリの内容は `/memory` で一覧表示・編集・削除が可能です。

### `/copy` コマンド — コードブロックの選択的コピー

レスポンスにコードブロックが含まれる場合、新しい `/copy` コマンドを使用するとインタラクティブなピッカーが表示されます。個別のコードブロックを選択してコピーするか、レスポンス全体をコピーするかを選べます。

```
/copy
```

複数のコードブロックが返ってくる場面（例：設定ファイルと実装コードが同時に提示される場合）で、目的のブロックだけを素早く取得できるようになりました。

## 改善点

### 複合 Bash コマンドに対するスマートな "always allow" プレフィックス提案

`&&` で繋いだ複合コマンドに対する "always allow"（常に許可）のプレフィックス提案が改善されました。以前はコマンド全体をひとまとめに扱っていましたが、今回からサブコマンドごとに適切なプレフィックスを算出します。

例えば以下のような複合コマンドの場合：

```bash
cd /tmp && git fetch && git push
```

以前は `cd /tmp && git fetch && git push` 全体を1つの許可対象として扱っていましたが、今後は `cd /tmp`、`git fetch`、`git push` それぞれに対してスマートなプレフィックスが提案されます。これにより、過剰に広い権限を付与することなく、細かい粒度で信頼設定を管理できます。

### 短いタスクリストの順序改善

タスクリストが短い場合の表示順序が改善されました。より直感的で優先度に沿った順序でタスクが並ぶようになります。

### マルチエージェントセッションのメモリ使用量改善

マルチエージェントセッションにおいて、完了したサブエージェントのタスク状態を解放するようになりました。これにより、長時間・大規模なマルチエージェントセッションでのメモリ消費が抑制され、安定性が向上します。

## バグ修正

### MCP OAuth トークン更新の競合状態を修正

複数の Claude Code インスタンスを同時に起動している場合に発生していた、MCP（Model Context Protocol）の OAuth トークン更新における競合状態（race condition）を修正しました。複数インスタンスが同時にトークン更新を試みると、認証エラーや予期しない動作が起きる可能性がありましたが、今回の修正により安定した動作が保証されます。

### 作業ディレクトリ削除時のシェルコマンドエラー表示を改善

作業ディレクトリが削除された状態でシェルコマンドを実行しようとした際に、明確なエラーメッセージが表示されなかった問題を修正しました。原因が分かりにくいエラーが発生していましたが、今後は「作業ディレクトリが存在しない」ことを示す明確なメッセージが表示されます。

## 技術的なポイント

- **auto-memory の管理**: `/memory` コマンドで保存済みメモリを確認・編集できます。不要な情報が蓄積した場合も手動で削除可能です
- **`/copy` のユースケース**: 複数のファイルやスニペットを同時に提示するような場面で特に有用です。ターミナル上での作業効率が向上します
- **複合コマンドの権限管理**: `&&` で繋いだコマンドのサブコマンドごとに細かい "always allow" 設定が可能になるため、セキュリティと利便性のバランスを保ちやすくなります
- **マルチエージェントの安定性**: 完了済みサブエージェントの状態解放により、大規模なエージェントオーケストレーションでのリソース枯渇リスクが低減します
- **MCP の信頼性向上**: 複数インスタンスを並行運用する開発環境（CI/CD パイプライン、チーム開発など）での MCP 利用が安定します

## まとめ

v2.1.59 は、セッションをまたいだコンテキスト継続性（auto-memory）と操作性（`/copy` コマンド）の両面を強化したリリースです。特に auto-memory は、長期的なプロジェクトでの Claude Code 活用を大きく後押しする機能となりそうです。マルチエージェントセッションのメモリ改善や MCP の競合状態修正といったインフラ面の安定化も、実運用環境での信頼性向上に貢献します。引き続き Claude Code の更新情報に注目していきましょう。
