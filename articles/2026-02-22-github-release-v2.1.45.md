---
title: "Claude Code v2.1.45 リリース — Claude Sonnet 4.6 対応とメモリ・起動パフォーマンスの大幅改善"
date: 2026-02-22
source: github-release
source_url: "https://github.com/anthropics/claude-code/releases/tag/v2.1.45"
identifier: "v2.1.45"
---

# Claude Code v2.1.45 リリース — Claude Sonnet 4.6 対応とメモリ・起動パフォーマンスの大幅改善

## 概要

Claude Code v2.1.45 では、新モデル **Claude Sonnet 4.6** へのサポートが追加されたほか、SDK へのレート制限情報の公開やスピナーチップのカスタマイズ機能など、開発者向けの拡張機能が強化されています。また、macOS のサンドボックスエラーや Agent Teams の Bedrock/Vertex/Foundry 環境での失敗など、複数の重要なバグが修正され、起動時間とメモリ使用量の改善も含まれます。

## 新機能

### Claude Sonnet 4.6 のサポート

最新モデルである **Claude Sonnet 4.6** が利用可能になりました。モデル ID は `claude-sonnet-4-6` です。新しいモデルを使用するには、設定または環境変数でモデル名を更新してください。

### `--add-dir` ディレクトリからのプラグイン設定読み込み

`--add-dir` フラグで追加したディレクトリ内の設定ファイルから、`enabledPlugins` と `extraKnownMarketplaces` が読み込まれるようになりました。これにより、プロジェクトごとのプラグイン構成をディレクトリ単位で管理できるようになります。

```jsonc
// .claude/settings.json（--add-dir で追加したディレクトリ内）
{
  "enabledPlugins": ["my-plugin"],
  "extraKnownMarketplaces": ["https://example.com/marketplace"]
}
```

### スピナーチップのカスタマイズ（`spinnerTipsOverride`）

処理中に表示されるスピナーのヒントメッセージをカスタマイズできる `spinnerTipsOverride` 設定が追加されました。

```jsonc
// settings.json
{
  "spinnerTipsOverride": {
    "tips": [
      "コードレビュー中...",
      "最適な実装を検討中..."
    ],
    "excludeDefault": true  // デフォルトのヒントを非表示にする場合
  }
}
```

- `tips`: 表示するカスタムヒント文字列の配列
- `excludeDefault`: `true` に設定するとデフォルトのヒントを除外し、カスタムヒントのみを表示

### SDK へのレート制限情報の追加

SDK に `SDKRateLimitInfo` および `SDKRateLimitEvent` 型が追加されました。これにより、SDK コンシューマーがレート制限の状態をリアルタイムで受け取れるようになります。取得できる情報は以下の通りです。

- **利用率 (utilization)**: 現在のレート制限に対する使用量の割合
- **リセット時刻 (reset times)**: 制限がリセットされるタイミング
- **超過情報 (overage information)**: 制限を超えた場合の詳細

独自のツールやダッシュボードを構築している開発者にとって、API 使用量の監視・管理が大幅に容易になります。

## 改善点

### 起動パフォーマンスの向上

セッション履歴の統計キャッシュ用の Eager Loading（先読み）を廃止し、遅延ロードに変更しました。これにより、特にセッション数が多い環境での起動時間が短縮されます。

### シェルコマンドのメモリ使用量の最適化

大量の出力を生成するシェルコマンドを実行した際に RSS（Resident Set Size）メモリが無制限に増大する問題が改善されました。長時間実行するシェルコマンドや大量のログを出力するコマンドを多用する場合でも、メモリ使用量が安定します。

### 折りたたみ読み取り/検索グループの表示改善

折りたたまれた読み取り・検索グループに、現在処理中のファイル名や検索パターンをサマリー行の下部にリアルタイムで表示するようになりました。処理状況を確認しやすくなります。

### [VSCode] 権限設定の永続化

VSCode 拡張機能において、権限の設定先（プロジェクト / ユーザー / セッション）の選択がセッションをまたいで保持されるようになりました。毎回同じ選択を繰り返す手間が省けます。

## バグ修正

### Agent Teams の Bedrock / Vertex / Foundry での失敗 (#23561)

Agent Teams 機能において、チームメンバーが Bedrock、Vertex、Foundry 環境で失敗する問題が修正されました。原因は tmux でスポーンされるプロセスに API プロバイダーの環境変数が伝播されていなかったためで、今回の修正でこれらの変数が正しく引き継がれるようになりました。マルチクラウド環境で Agent Teams を活用している場合は、この修正による安定性向上が見込まれます。

### macOS サンドボックスの「operation not permitted」エラー (#21654)

macOS のサンドボックス環境で一時ファイルを書き込む際に発生していた `operation not permitted` エラーが修正されました。ユーザーごとの正しい一時ディレクトリ（`/var/folders/...` など）を使用するよう変更されています。

### Task ツール（バックグラウンドエージェント）の `ReferenceError` クラッシュ (#22087)

Task ツールを使用したバックグラウンドエージェントが完了時に `ReferenceError` でクラッシュする問題が修正されました。バックグラウンドタスクを多用するワークフローの信頼性が向上します。

### 画像貼り付け時のオートコンプリート確定

入力フィールドに画像を貼り付けた状態でオートコンプリートの候補が表示されている際、Enter キーで候補を確定できなかった問題が修正されました。

### サブエージェントのスキルがメインセッションに残る問題

サブエージェントが呼び出したスキルが、コンパクション（コンテキスト圧縮）後にメインセッションのコンテキストに誤って残り続ける問題が修正されました。

### `.claude.json.backup` ファイルの過剰蓄積

Claude Code の起動のたびに `.claude.json.backup` ファイルが生成・蓄積される問題が修正されました。ディスク容量の圧迫を防ぐための修正です。

### プラグインのコマンド・エージェント・フックの即時利用

プラグインをインストールした直後から、Claude Code を再起動することなくプラグインが提供するコマンド、エージェント、フックが利用できるようになりました。プラグイン開発・導入時のイテレーション速度が向上します。

## 技術的なポイント

- **Claude Sonnet 4.6** が利用可能になり、モデル ID `claude-sonnet-4-6` で最新モデルへのアクセスが可能
- **`SDKRateLimitInfo` / `SDKRateLimitEvent`** を活用することで、SDK ベースのツールにレート制限モニタリング機能を組み込める
- **`spinnerTipsOverride`** はチームやプロジェクト固有のブランディングや案内メッセージを表示する用途にも活用可能
- **`--add-dir` のプラグイン設定対応**により、モノレポや複数プロジェクトを持つ環境でプラグイン構成をディレクトリ単位で分離・管理できる
- macOS サンドボックスの修正は、セキュリティが強化された環境（Hardened Runtime など）で Claude Code を運用している場合に特に重要
- Agent Teams を Bedrock / Vertex / Foundry で使用している場合は、今回の修正でチーム機能の信頼性が大幅に向上する

## まとめ

v2.1.45 は、新モデル Claude Sonnet 4.6 の対応に加え、起動パフォーマンス・メモリ効率の改善、そして複数の重要なバグ修正を含む充実したリリースです。特に、macOS サンドボックス環境や Agent Teams をマルチクラウドで利用しているユーザーへの影響が大きい修正が含まれています。SDK への `SDKRateLimitInfo` 追加は、Claude Code を組み込んだ独自ツールの開発においても活用できる重要な拡張です。アップデートを適用して最新の機能と安定性の恩恵を受けることをお勧めします。
