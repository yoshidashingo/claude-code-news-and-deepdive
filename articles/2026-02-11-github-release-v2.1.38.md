---
title: "Claude Code v2.1.38 リリース: バグ修正とセキュリティ強化"
date: 2026-02-11
source: github-release
source_url: "https://github.com/anthropics/claude-code/releases/tag/v2.1.38"
identifier: "v2.1.38"
---

# Claude Code v2.1.38 リリース: バグ修正とセキュリティ強化

## 概要

Claude Code v2.1.38 がリリースされました。このバージョンでは、v2.1.37で発生したターミナルスクロールの不具合や、タブキーによるオートコンプリートの問題など、5つの主要なバグが修正されています。加えて、heredocデリミタのパース改善によるセキュリティ強化と、サンドボックスモードでのディレクトリ書き込み制限も実装されました。

## 改善点

### Heredocデリミタパースの改善

heredocデリミタの解析処理が改善され、コマンドスマグリング（command smuggling）攻撃を防止できるようになりました。これにより、bashコマンド内でheredoc構文を使用する際の安全性が向上しています。

heredocはシェルスクリプトで複数行の文字列を扱う際に使用される構文ですが、デリミタの解析が不適切だと、意図しないコマンドが実行されるリスクがありました。今回の改善により、Claude Codeがbashコマンドを生成・実行する際の安全性が強化されています。

### サンドボックスモードのセキュリティ強化

サンドボックスモードにおいて、`.claude/skills` ディレクトリへの書き込みがブロックされるようになりました。これにより、サンドボックス環境でのスキル定義ファイルの意図しない変更を防ぐことができます。

`.claude/skills` ディレクトリは Claude Code のカスタムスキル（コマンドの拡張機能）を定義する重要なディレクトリです。サンドボックスモードでこの領域への書き込みを制限することで、悪意のあるコードや誤った操作によるシステム設定の改変を防いでいます。

## バグ修正

### VS Code ターミナルのスクロール問題

v2.1.37で発生していた、VS Code拡張機能のターミナルが自動的にトップまでスクロールしてしまう不具合が修正されました。この問題により、コマンド実行結果を確認する際に不便が生じていましたが、正常なスクロール動作に戻っています。

### タブキーのオートコンプリート

タブキーを押した際に、オートコンプリートが正常に機能せずスラッシュコマンドがキューに追加されてしまう問題が解決されました。これにより、通常のエディタと同様にタブキーでコード補完が行えるようになりました。

### 環境変数ラッパーを使用したbashコマンドの権限マッチング

環境変数ラッパーを使用するbashコマンドの権限マッチングが正しく機能していなかった問題が修正されました。例えば、以下のような環境変数を設定してからコマンドを実行する場合です。

```bash
ENV_VAR=value some_command --option
```

このような形式のコマンドに対して、権限チェックが適切に行われるようになり、より柔軟なコマンド実行が可能になっています。

### ストリーミング非使用時のテキスト消失

ストリーミングを使用しない場合に、ツール呼び出しの間のテキストが消失してしまう問題が修正されました。これにより、Claude Codeの応答がストリーミング有無に関わらず、一貫して表示されるようになりました。

### VS Code拡張機能でのセッション重複

VS Code拡張機能で作業を再開する際に、セッションが重複して作成されてしまう問題が解決されました。これにより、作業履歴やコンテキストの管理がより正確に行われるようになっています。

## 技術的なポイント

- **セキュリティ強化**: heredocパーサーの改善とサンドボックスモードでの書き込み制限により、コマンドインジェクション攻撃への耐性が向上
- **VS Code統合の安定性向上**: ターミナルスクロールとセッション管理の不具合修正により、VS Code拡張機能の使用体験が改善
- **権限システムの精緻化**: 環境変数ラッパーを含むbashコマンドに対する権限マッチングの修正により、より複雑なコマンドパターンに対応
- **UI/UXの一貫性**: タブキーの動作修正とストリーミング時のテキスト表示問題の解決により、エディタとしての基本機能が安定化

## まとめ

v2.1.38は、前バージョンで発生した不具合の修正を中心とした安定性向上リリースです。特にVS Code拡張機能を使用しているユーザーにとっては、ターミナルスクロールとセッション管理の問題が解決されたことで、より快適な開発体験が得られるでしょう。

また、heredocパーサーの改善とサンドボックスモードの強化は、Claude Codeのセキュリティ面での信頼性を高める重要な変更です。特にチームで使用する場合や、信頼できないコードベースを扱う際に、これらのセキュリティ機能が重要な役割を果たします。

今後も継続的な品質改善とセキュリティ強化が期待されます。
