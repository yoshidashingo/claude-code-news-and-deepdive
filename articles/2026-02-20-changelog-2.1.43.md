---
title: "Claude Code v2.1.43 Changelog: AWS認証タイムアウト・エージェント警告・Vertex/Bedrockヘッダー修正"
date: 2026-02-20
source: changelog
source_url: "https://github.com/anthropics/claude-code/blob/main/CHANGELOG.md"
identifier: "2.1.43"
---

# Claude Code v2.1.43 Changelog: AWS認証タイムアウト・エージェント警告・Vertex/Bedrockヘッダー修正

## 概要

Claude Code v2.1.43 はバグ修正に特化したリリースです。AWS 認証のリフレッシュが無限にハングする問題、`.claude/agents/` ディレクトリでの不要な警告表示、そして Vertex AI / Amazon Bedrock 利用時の API ヘッダー誤送信という3件の問題が修正されました。いずれも実際の運用環境で影響が出やすい問題であり、特にクラウドプロバイダー経由で Claude Code を利用している開発者にとって重要なアップデートです。

## 変更点の詳細

### 1. AWS 認証リフレッシュの無限ハング修正

**修正内容**: AWS 認証情報のリフレッシュ処理が応答を返さないまま無限に待ち続ける問題に対し、**3分間のタイムアウト**を設定しました。

これまで、AWS の認証情報リフレッシュが何らかの理由でスタックした場合（ネットワーク障害・IAM エンドポイントの応答遅延など）、Claude Code のプロセス全体が停止状態になることがありました。タイムアウトを設定することで、一定時間内に認証が完了しない場合はエラーを返し、ユーザーが適切に対処できるようになります。

Amazon Bedrock を通じて Claude Code を利用している環境では、この修正によって信頼性が向上します。

### 2. `.claude/agents/` ディレクトリでの不要な警告を修正

**修正内容**: `.claude/agents/` ディレクトリ内に配置された、エージェント定義ではない Markdown ファイル（README.md やメモ用ファイルなど）に対して表示されていた**不要な警告を抑制**しました。

Claude Code のサブエージェント機能では、`.claude/agents/` ディレクトリに YAML frontmatter を持つ Markdown ファイルを配置してエージェントを定義します。しかしこのディレクトリに補足説明用の README や一般的な Markdown ファイルを置いた場合、エージェントとして認識できないという警告が誤って表示されていました。

この修正により、エージェント定義ファイルでないファイルは静かに無視されるようになり、`.claude/agents/` ディレクトリをより自由に活用できます。

### 3. Vertex AI / Bedrock への `structured-outputs` ベータヘッダーの誤送信を修正

**修正内容**: `structured-outputs` のベータ機能を示す API ヘッダーが、Vertex AI および Amazon Bedrock に対しても**無条件に送信されていた問題**を修正しました。

`structured-outputs` は Anthropic の直接 API でサポートされているベータ機能ですが、このヘッダーが Vertex AI や Bedrock のエンドポイントに送信されると、各プロバイダーが予期しないヘッダーとして処理し、エラーや予期しない動作を引き起こす可能性がありました。修正後は、このヘッダーは Anthropic の直接 API に対してのみ送信されます。

## 技術的なポイント

- **AWS 認証タイムアウト (3分)**: ネットワーク障害や IAM エンドポイントの問題が発生した際に Claude Code がハングしなくなります。Bedrock ユーザーは認証エラーが明示的に通知されるため、トラブルシューティングが容易になります
- **エージェントディレクトリの寛容な扱い**: `.claude/agents/` に README やドキュメントファイルを配置しても警告が出なくなります。チームでのエージェント管理や説明ファイルの共存が改善されます
- **プロバイダー別ヘッダー制御**: Anthropic API・Vertex AI・Amazon Bedrock でそれぞれ適切なヘッダーのみが送信されるようになります。マルチクラウド環境での安定性が向上します

## まとめ

v2.1.43 は新機能の追加はなく、3件のバグ修正に絞ったリリースです。しかし、いずれも AWS/Bedrock や Vertex AI などのエンタープライズ環境で Claude Code を利用する際に実際の影響が出やすい問題でした。

特に AWS Bedrock 経由での利用や、`.claude/agents/` を活用したサブエージェント開発を行っているチームには、早めのアップデートをお勧めします。クラウドプロバイダー経由での Claude Code 利用が増える中、各プロバイダーの API 仕様の差異に対応するための継続的な改善が行われていることが伺えます。
