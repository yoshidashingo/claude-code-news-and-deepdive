---
title: "Claude Code v2.1.45 リリース — Claude Sonnet 4.6 対応と多数のバグ修正"
date: 2026-02-21
source: github-release
source_url: "https://github.com/anthropics/claude-code/releases/tag/v2.1.45"
identifier: "v2.1.45"
---

# Claude Code v2.1.45 リリース — Claude Sonnet 4.6 対応と多数のバグ修正

## 概要

Claude Code v2.1.45 では、新モデル **Claude Sonnet 4.6** への対応が追加されました。また、SDK へのレート制限情報型の追加やスピナーカスタマイズ機能など開発者向けの新機能が揃っています。さらに、Agent Teams の Bedrock/Vertex/Foundry 環境での動作不良や macOS サンドボックスエラーを含む複数のバグが修正され、起動速度とメモリ効率も改善されています。

## 新機能

### Claude Sonnet 4.6 対応

最新モデルである **Claude Sonnet 4.6** がサポートされました。Claude Code の設定でモデルを `claude-sonnet-4-6` に指定することで、最新の能力を活用した開発支援が利用できます。

### `--add-dir` からのプラグイン設定読み込み

`--add-dir` オプションで指定したディレクトリから、`enabledPlugins` および `extraKnownMarketplaces` の設定を読み込めるようになりました。これにより、プロジェクト固有のプラグイン設定をリポジトリ内で管理しやすくなります。

### スピナーチップのカスタマイズ (`spinnerTipsOverride`)

処理中に表示されるスピナーのチップ（ヒントメッセージ）をカスタマイズできる `spinnerTipsOverride` 設定が追加されました。

```json
{
  "spinnerTipsOverride": {
    "tips": ["カスタムメッセージ1", "カスタムメッセージ2"],
    "excludeDefault": true
  }
}
```

- `tips`: 表示するカスタムメッセージの配列
- `excludeDefault: true`: デフォルトのチップを非表示にしてカスタムメッセージのみを表示

チームの用途に合わせたメッセージや、社内ツール向けのガイドラインを組み込む際に活用できます。

### SDK へのレート制限情報型の追加

SDK に `SDKRateLimitInfo` および `SDKRateLimitEvent` 型が追加されました。これらを使用することで、SDK を利用するアプリケーションがレート制限のステータスをリアルタイムで受け取れるようになります。

取得できる情報:
- **利用率 (utilization)**: 現在のレート制限に対する使用率
- **リセット時間 (reset times)**: レート制限がリセットされる時刻
- **超過情報 (overage information)**: 制限を超過した場合の詳細

レート制限に近づいた際に処理を遅らせたり、ユーザーへ通知したりといった制御ロジックの実装が容易になります。

## 改善点

### 起動パフォーマンスの向上

起動時に統計キャッシュ用のセッション履歴を先読みしていた処理を削除しました。これにより、特に大量のセッション履歴がある環境での起動が高速化されます。

### 大量出力コマンドのメモリ使用量改善

大量の出力を生成するシェルコマンド実行時に RSS（Resident Set Size）メモリが無制限に増加していた問題が解消されました。長時間稼働するエージェントや大規模なビルドコマンドを扱う場面でメモリ消費が安定します。

### 折りたたみ表示グループの UI 改善

読み込み・検索グループを折りたたんだ状態でも、現在処理中のファイルパスや検索パターンがサマリー行の下に表示されるようになりました。長時間かかる操作の進捗をより把握しやすくなります。

### [VSCode] 権限設定先の永続化

VSCode 拡張機能において、ツール使用時の権限付与先（プロジェクト / ユーザー / セッション）の選択がセッションをまたいで保持されるようになりました。毎回設定し直す手間が省けます。

## バグ修正

### Agent Teams が Bedrock / Vertex / Foundry で失敗する問題

`tmux` で生成されるサブプロセスに API プロバイダの環境変数が正しく伝播されていなかったため、Agent Teams のチームメイトが Bedrock、Vertex、Foundry 環境で失敗していた問題を修正しました ([#23561](https://github.com/anthropics/claude-code/issues/23561))。

### macOS サンドボックスの "operation not permitted" エラー

macOS で一時ファイルを書き込む際に発生していた `operation not permitted` エラーを修正しました。ユーザーごとの正しい一時ディレクトリを使用するように変更されています ([#21654](https://github.com/anthropics/claude-code/issues/21654))。

### Task ツール (バックグラウンドエージェント) の `ReferenceError` クラッシュ

Task ツールで起動したバックグラウンドエージェントが完了時に `ReferenceError` でクラッシュしていた問題を修正しました ([#22087](https://github.com/anthropics/claude-code/issues/22087))。

### 画像貼り付け時のオートコンプリート不具合

入力欄に画像を貼り付けた状態で Enter キーを押してもオートコンプリートの候補が受け入れられなかった問題を修正しました。

### サブエージェントのスキルがメインセッションに誤表示される問題

サブエージェントが呼び出したスキルが、圧縮（compaction）後にメインセッションのコンテキストに誤って表示されていた問題を修正しました。

### `.claude.json.backup` ファイルの過剰な蓄積

起動のたびに `.claude.json.backup` ファイルが生成・蓄積されていた問題を修正しました。ディスク容量を不必要に消費していたケースに対応します。

### プラグインのコマンド・エージェント・フックが再起動なしで利用可能に

プラグインをインストールした直後、再起動なしでそのプラグインが提供するコマンド、エージェント、フックが即座に使用できるようになりました。

## 技術的なポイント

- **Claude Sonnet 4.6 対応**: 最新モデルを Claude Code から即座に利用可能。高度なタスクでの精度向上が期待できます。
- **SDK レート制限 API**: `SDKRateLimitInfo` / `SDKRateLimitEvent` を活用することで、SDK を組み込んだアプリケーションでよりきめ細かいレート制御が実現できます。
- **`spinnerTipsOverride`**: 社内ツールや OSS プロジェクトでカスタムブランディングや案内メッセージを埋め込む際に有用です。
- **tmux 環境変数の伝播修正**: マルチエージェント構成で複数の AI プロバイダを使用する場合の信頼性が向上しました。
- **メモリリーク修正**: 長時間実行エージェントや CI 環境での安定稼働に直接影響する重要な改善です。
- **プラグインの即時反映**: 開発中のプラグイン作業で再起動の手間が不要になり、イテレーション速度が上がります。

## まとめ

v2.1.45 は Claude Sonnet 4.6 という最新モデルへの対応を筆頭に、Agent Teams のマルチプロバイダ対応強化、SDK のレート制限情報取得、macOS のサンドボックスエラー修正など、実運用上で影響の大きい変更が多く含まれています。特にメモリ改善と起動高速化は、CI/CD パイプラインや長時間稼働するエージェント環境での安定性向上に貢献します。Claude Code を業務で活用している開発者はアップデートを検討することをお勧めします。
