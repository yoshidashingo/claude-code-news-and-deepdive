---
title: "Claude Code v2.1.45 リリース — Claude Sonnet 4.6 対応・SDK レート制限情報の追加・多数のバグ修正"
date: 2026-02-20
source: github-release
source_url: "https://github.com/anthropics/claude-code/releases/tag/v2.1.45"
identifier: "v2.1.45"
---

# Claude Code v2.1.45 リリース — Claude Sonnet 4.6 対応・SDK レート制限情報の追加・多数のバグ修正

## 概要

Claude Code v2.1.45 では、最新モデルである **Claude Sonnet 4.6** のサポートが追加されたほか、SDK へのレート制限情報の追加やスピナーチップスのカスタマイズ機能など、開発者向けの新機能が複数導入されました。また、macOS でのサンドボックスエラーや Agent Teams の Bedrock/Vertex/Foundry 上の不具合など、実用上影響の大きいバグが複数修正され、起動パフォーマンスやメモリ使用量の改善も実施されています。

## 新機能

### Claude Sonnet 4.6 のサポート

最新の Claude Sonnet 4.6 モデルが Claude Code で利用可能になりました。Sonnet 4.6 は Claude 4 ファミリーの最新世代で、コーディングタスクにおけるパフォーマンスや応答品質の向上が期待できます。

### `spinnerTipsOverride` によるスピナーチップスのカスタマイズ

新しい `spinnerTipsOverride` 設定を使って、処理待ち中に表示されるスピナーのヒントメッセージをカスタマイズできるようになりました。

```json
{
  "spinnerTipsOverride": {
    "tips": ["カスタムヒント1", "カスタムヒント2"],
    "excludeDefault": true
  }
}
```

- `tips`: 表示するカスタムヒント文字列の配列を指定します
- `excludeDefault: true`: デフォルトの組み込みヒントを非表示にし、カスタムヒントのみを表示します。省略するとカスタムヒントとデフォルトヒントが混在して表示されます

チームや組織独自のガイドラインやTipsを表示させたい場合に活用できます。

### `--add-dir` ディレクトリからのプラグイン設定読み込み

`--add-dir` オプションで指定したディレクトリから、`enabledPlugins` および `extraKnownMarketplaces` の設定を読み込めるようになりました。これにより、プロジェクト単位やチーム単位でのプラグイン管理が柔軟になります。

### SDK への `SDKRateLimitInfo` / `SDKRateLimitEvent` 型の追加

SDK に `SDKRateLimitInfo` と `SDKRateLimitEvent` の型が追加されました。これらを使うことで、API のレート制限に関する状態をリアルタイムに受信できます。

受信できる情報の例:
- **利用率 (utilization)**: 現在のレート制限に対する使用割合
- **リセット時刻 (reset times)**: 制限がリセットされるタイミング
- **超過情報 (overage information)**: 制限を超えた場合の詳細

大規模な自動化パイプラインや Agent を構築している開発者にとって、スロットリングの制御やエラーハンドリングに役立つ情報です。

## 改善点

### 起動パフォーマンスの向上

起動時に統計キャッシュのためにセッション履歴を先読みしていた処理を削除し、起動速度が改善されました。セッション数が多い環境では効果を実感しやすくなります。

### シェルコマンドのメモリ使用量改善

大量の出力を生成するシェルコマンドの実行時に、RSS（Resident Set Size）メモリが際限なく増加する問題が解消されました。長時間のビルドやログ出力が多いコマンドを実行する際のメモリ安定性が向上しています。

### 折りたたみグループの表示改善

折りたたまれた read/search グループで、処理中のファイル名や検索パターンがサマリー行の下にリアルタイムで表示されるようになりました。どのファイルを処理中かを把握しやすくなります。

### [VSCode] パーミッション設定の永続化

VSCode 拡張機能において、パーミッションの保存先（project / user / session）の選択がセッションをまたいで維持されるようになりました。毎回設定し直す手間が省けます。

## バグ修正

### Agent Teams が Bedrock / Vertex / Foundry で失敗する問題の修正 (#23561)

Agent Teams のチームメンバー（サブエージェント）が、Amazon Bedrock・Google Vertex AI・Azure AI Foundry 環境で起動に失敗する問題が修正されました。tmux で生成されるプロセスに API プロバイダーの環境変数が正しく伝播されていなかったことが原因で、環境変数の伝播処理を修正することで解決されました。

### macOS でのサンドボックス「operation not permitted」エラーの修正 (#21654)

macOS の sandbox 環境で一時ファイルを書き込む際に「operation not permitted」エラーが発生していた問題が修正されました。ユーザーごとの正しい一時ディレクトリ（per-user temp directory）を使用するよう修正されています。

### Task ツール（バックグラウンドエージェント）が `ReferenceError` でクラッシュする問題の修正 (#22087)

Task ツールでバックグラウンド実行されたエージェントが完了時に `ReferenceError` でクラッシュしていた問題が修正されました。

### 画像ペースト時のオートコンプリート Enter 受け付け問題の修正

入力欄に画像をペーストした状態でオートコンプリートの候補を Enter キーで確定できなかった問題が修正されました。

### サブエージェントのスキルがメインセッションに誤表示される問題の修正

サブエージェントから呼び出されたスキルが、コンパクション後にメインセッションのコンテキストに誤って表示されていた問題が修正されました。

### `.claude.json.backup` ファイルが蓄積する問題の修正

起動のたびに `.claude.json.backup` ファイルが過剰に生成・蓄積されていた問題が修正されました。

### プラグインのインストール直後に反映されない問題の修正

インストール直後のプラグインが提供するコマンド・エージェント・フックが、再起動なしに利用可能になりました。これまではインストール後に再起動が必要でしたが、この修正によりシームレスにプラグインを使い始められます。

## 技術的なポイント

- **Claude Sonnet 4.6 対応**: モデルの指定設定を確認し、必要に応じてアップグレードを検討してください
- **SDK のレート制限 API**: `SDKRateLimitEvent` を購読することで、エージェントパイプラインでのレート制限対策が実装しやすくなります
- **`spinnerTipsOverride`**: `excludeDefault: true` を使えば、組織のガイドラインやエンジニアリングTipsをカスタム表示できます
- **`--add-dir` によるプラグイン管理**: モノレポやチーム開発環境でプロジェクト固有のプラグイン設定を一元管理できます
- **macOS サンドボックス修正**: 影響を受けていたユーザーは、アップデート後に再度動作確認することを推奨します
- **メモリ改善**: 大量出力を伴う CI/CD パイプラインなどでの長時間実行が安定します

## まとめ

v2.1.45 は Claude Sonnet 4.6 への対応という大きな機能追加に加え、Agent Teams の Bedrock/Vertex/Foundry 対応や macOS サンドボックスエラーなど、ユーザーから報告されていた実用上重要なバグが修正されたリリースです。SDK へのレート制限情報の追加は、複雑なエージェントパイプラインを構築する開発者にとって有用な機能拡張です。起動パフォーマンスとメモリ効率の改善も継続されており、大規模な利用環境での安定性向上が期待できます。
