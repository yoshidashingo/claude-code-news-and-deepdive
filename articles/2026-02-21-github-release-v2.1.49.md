---
title: "Claude Code v2.1.49 リリース — パフォーマンス大幅改善とエンタープライズ向け新機能"
date: 2026-02-21
source: github-release
source_url: "https://github.com/anthropics/claude-code/releases/tag/v2.1.49"
identifier: "v2.1.49"
---

# Claude Code v2.1.49 リリース — パフォーマンス大幅改善とエンタープライズ向け新機能

## 概要

Claude Code v2.1.49 では、起動時のパフォーマンス改善を中心に多数の最適化が行われました。MCP サーバーの認証失敗キャッシングや API 呼び出しのバッチ処理など、起動速度に影響する複数の改善が含まれています。また、エンタープライズ向けに設定変更を検知する `ConfigChange` フックが追加され、セキュリティ監査のユースケースが強化されました。加えて、長時間セッションでの WASM メモリリーク問題が修正されるなど、安定性向上も図られています。

## 新機能

### Simple Mode でファイル編集が可能に

環境変数 `CLAUDE_CODE_SIMPLE` で有効化される Simple Mode（シンプルモード）に、これまでの Bash ツールに加えてファイル編集ツールが追加されました。これにより、Simple Mode でもファイルの直接編集が可能になります。

```bash
# Simple Mode を有効化してファイル編集も利用可能に
export CLAUDE_CODE_SIMPLE=1
claude
```

### ConfigChange フックイベントの追加

セッション中に設定ファイルが変更された際に発火する `ConfigChange` フックイベントが追加されました。エンタープライズ環境でのセキュリティ監査や、ポリシーに反する設定変更のブロックなどのユースケースに対応できます。

```json
{
  "hooks": {
    "ConfigChange": [
      {
        "command": "your-audit-script.sh"
      }
    ]
  }
}
```

### SDK モデル情報の拡充

SDK のモデル情報に新たなフィールドが追加されました。

- `supportsEffort`: effort（努力）レベルの設定サポートの有無
- `supportedEffortLevels`: 利用可能な effort レベルの一覧
- `supportsAdaptiveThinking`: Adaptive Thinking（適応的思考）のサポートの有無

SDK を利用するアプリケーションがモデルの機能を動的に検知できるようになり、モデルごとの機能差を吸収したロジックが実装しやすくなります。

### 権限提案の充実

安全性チェックが ask レスポンスをトリガーした際に、権限オプションが自動的に提案されるようになりました。SDK を利用するアプリケーションで、ユーザーへの権限選択肢の表示が容易になります。

## 改善点

### 起動パフォーマンスの大幅改善

複数の最適化により、起動時のオーバーヘッドが削減されました。

- **MCP 認証失敗のキャッシング**: HTTP および SSE MCP サーバーへの認証失敗を記録し、起動時に繰り返し接続を試みないようにしました。認証が必要なサーバーへの冗長な接続試行が排除されます。
- **MCP ツールのトークンカウントバッチ処理**: MCP ツールのトークンカウントを単一の API 呼び出しにまとめることで、起動時の HTTP 呼び出し数を削減しました。
- **アナリティクストークンカウントの最適化**: 分析用のトークンカウントに関する HTTP 呼び出しを削減しました。
- **非インタラクティブモード（`-p`）の改善**: 起動時に不要な API 呼び出しをスキップするようにしました。

### バックグラウンドエージェント実行時の Ctrl+C / ESC 改善

バックグラウンドエージェントが実行中でメインスレッドがアイドル状態のとき、Ctrl+C や ESC が無視されていた問題が修正されました。**3秒以内に2回押すと、すべてのバックグラウンドエージェントが終了**するようになりました。

### 権限プロンプトのコンテキスト表示

パスの安全性チェックやワーキングディレクトリのブロックが発生した際の権限プロンプトに、制限の理由が表示されるようになりました。従来は理由なしにプロンプトが表示されていましたが、今後はより分かりやすいメッセージが確認できます。

## バグ修正

### メモリリーク関連

**WASM メモリの無制限増加**（2件）が修正されました。

- **tree-sitter パーサの定期リセット**: 長時間セッションでの tree-sitter パーサによる WASM メモリの無制限増加を修正しました。パーサを定期的にリセットすることで、メモリ使用量が抑制されます。
- **Yoga WASM リニアメモリ**: Yoga（レイアウトエンジン）の WASM リニアメモリが縮小しない問題を修正しました。長時間セッションでのメモリ使用量増加が解消されます。

### プラグイン管理

`plugin enable` および `plugin disable` コマンドで `--scope` オプションを指定しない場合、常にユーザースコープがデフォルトになっていた問題を修正しました。現在は適切なスコープが自動検出されます。

### プロンプト提案キャッシュの回帰修正

キャッシュヒット率を低下させていた回帰バグを修正しました。プロンプト提案のパフォーマンスが改善されます。

### verbose モードの表示不具合

`/config` コマンドで verbose モード（詳細表示モード）をトグルしても、thinking block（思考ブロック）の表示が更新されない問題を修正しました。メモ比較処理が verbose の変更を正しく検知するようになりました。

### `disableAllHooks` のポリシー適用

`disableAllHooks` 設定がマネージド設定階層を正しく尊重するよう修正されました（Issue #26637）。マネージド（管理対象）でない設定から、管理ポリシーで設定されたフックを無効化できなくなりました。

### `--resume` セッションピッカーの XML タグ表示問題

`--resume` フラグのセッション選択画面で、`/clear` などのコマンドで始まるセッションに生の XML タグが表示されていた問題を修正しました。

### stale yoga レイアウト参照によるレンダリング問題

古い yoga レイアウト参照が原因で発生していた潜在的なレンダリングの問題を修正しました。

## モデル変更

**Max プランにおける Sonnet 4.5 の廃止**

Max プランで 1M コンテキストを持つ Sonnet 4.5 が廃止され、同じ 1M コンテキストに対応したフロンティアモデル **Sonnet 4.6** が採用されました。現在 Sonnet 4.5 をご利用の方は、`/model` コマンドでモデルを切り替えることを推奨します。

```
/model
```

## 技術的なポイント

- **長時間セッションの安定性向上**: tree-sitter と Yoga の WASM メモリ問題が両方修正されたことで、長時間稼働するセッションでのメモリ使用量が大幅に改善されます
- **エンタープライズセキュリティの強化**: `ConfigChange` フックにより、設定変更の監査やポリシー違反のブロックが実現可能になりました
- **SDK 利用者向けモデル機能検知**: `supportsEffort` や `supportsAdaptiveThinking` フィールドの追加により、モデルの機能を動的に判断するロジックの実装が容易になりました
- **MCP パフォーマンスの改善**: 認証失敗のキャッシングとバッチ処理により、多数の MCP サーバーを使用している環境では起動時間の短縮が期待できます
- **ポリシー管理の強化**: `disableAllHooks` のバグ修正により、マネージド環境でのセキュリティポリシーが意図通りに機能するようになりました

## まとめ

v2.1.49 は、パフォーマンスと安定性を重視したリリースです。特に起動時のオーバーヘッド削減と長時間セッションでのメモリリーク修正は、日常的な開発での体験向上に直結します。エンタープライズ向けには `ConfigChange` フックや `disableAllHooks` のポリシー修正など、セキュリティ管理を強化する改善が含まれています。Max プランをご利用の方は Sonnet 4.5 から Sonnet 4.6 への切り替えをお忘れなく行ってください。
